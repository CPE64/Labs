%| Weekly report template for CSUS Senior Design
%|
%| language: LaTeX
%| Author: Ben Smith
%| 
%| This source has been tagged with the "<CHANGE" tag in areas
%| that require updating when making a new docuent
%|
%| This source will generate a PDF file complete with thumbnails navigation menu and metadata.
%| Much of the tex awesomeness comes from http://www.michaelshell.org/ praise be to him for creating the guide

\documentclass[12pt,journal]{IEEEtran}

\newcommand{\TITLE}{Lab Five: State Machines}
\newcommand{\KEYWORDS}{Logic Gates, Verilog, FPGA, Signaltap, Synthesis}
\newcommand{\ABSTRACT}{Two input logic gates are synthesized for the Altera Cyclone IV FPGA using the Quartus IDE. The logic
                       gates are verified using a System Verilog testbench and Mentor's Modelsim HDL simulator}

%| Override compsoc class' Palatino font for body text, restores to Times New Roman
\renewcommand{\rmdefault}{ptm}\selectfont

%| IEEE Citation package
\usepackage{cite}

\usepackage[cmex10]{amsmath}        %| Asmerican Mathematical Society package for fancy maths  
\interdisplaylinepenalty=2500       %| Restores IEEE line spacing after amsmath

%| Better tables than LaTeX 2e
\usepackage{array}
\usepackage{graphicx}
\usepackage{float}
\usepackage{url}                    %| Improved URL handling
\usepackage{minted}
\usepackage{etoolbox}
\AtBeginEnvironment{minted}{\singlespacing
    \fontsize{9}{p}\selectfont}

%| Enables PDF metadata, thumbnails, and navigation
\newcommand\MYhyperrefoptions{
  bookmarks=true,
  bookmarksnumbered=true,
  pdfpagemode={UseOutlines},
  plainpages=false,
  pdfpagelabels=true,
  colorlinks=true,
  linkcolor={black},
  citecolor={black},
  urlcolor={blue},
  pdftitle={CPE/EEE 64: Lab One},
  pdfsubject={Engineering},                        
  pdfauthor={California State University Sacramento},
  pdfkeywords={\KEYWORDS}}                       

\usepackage{listings}
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.9,0.9,0.9}
\definecolor{mymauve}{rgb}{0.58,0,0.52}
\lstset{
  backgroundcolor=\color{mygray},     % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  basicstyle=\tiny\ttfamily,  % the size of the fonts that are used for the code
  breakatwhitespace=false,            % sets if automatic breaks should only happen at whitespace
  breaklines=true,                    % sets automatic line breaking
  captionpos=b,                       % sets the caption-position to bottom
  commentstyle=\color{mygreen},       % comment style
  deletekeywords={...},               % if you want to delete keywords from the given language
  escapeinside={\%*}{*)},             % if you want to add LaTeX within your code
  extendedchars=true,                 % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
  frame=single,                       % adds a frame around the code
  keepspaces=true,                    % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle=\color{blue},          % keyword style
  language=Verilog,                   % the language of the code
  morekeywords={*,...},               % if you want to add more keywords to the set
  numbers=left,                       % where to put the line-numbers; possible values are (none, left, right)
  numbersep=5pt,                      % how far the line-numbers are from the code
  numberstyle=\tiny\color{mygray},    % the style that is used for the line-numbers
  rulecolor=\color{black},            % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                   % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,             % underline spaces within strings only
  showtabs=false,                     % show tabs within strings adding particular underscores
  stepnumber=2,                       % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{mymauve},        % string literal style
  tabsize=1,                          % sets default tabsize to 2 spaces
  %title=\lstname                      % show the filename of files included with \lstinputlisting; also try caption instead of title
}

%| Calls hyperref package with the options specified above
\usepackage[\MYhyperrefoptions,pdftex]{hyperref}

\begin{document}
%| Inserts header cover sheet 
\include{Title_Page}
\include{TOC}

  %| =================================================================================================
  %| Introduction
  %| =================================================================================================
  \section{ Introduction}
    \PARstart{I}{n} this lab state machines will be explored. We will walk through a number of examples from Altera to investigate the different types of state machines available to the digitial designer and why you might choose a particular one.

      \subsubsection{The Case Statement}
       The ``Enumeration'' of case statements is the first unique feature of System Verilog that we will use in these labs. before you could have named your files .v or .sv and it would not have mattered. Now for the project to compile, it must be .sv.

    \subsection{Implement state machine using state table and K-Map}

    \subsection{The Difference between Meely and Moore State Machines}

    %| The Case Statement
    %| =================================================================================================
    \section{The Case Statement}
      Verilog makes use of the case statement like most other progamming languages. The case statement provides a clear way for your code to step through a procedure. It is common to implement a state machine using the case statement for a number of reasons.
      \begin{enumerate}
        \item Enumerated types show up in Signaltap for easy debugging.
        \item The organized syntax creates more readable code.
        \item easily expandable to include more states.
      \end{enumerate}

    %| The state machine
    %| =================================================================================================
    \section{The state machine}
      This lab will assume that you have had a basic introduction to state machines in the lecture. We will cover some topics that are particular to the FPGA and HDL implementation of the logic. Altera offers a number of templates for the creation of a state machine\cite{Altera:QuartusHandbook}:
        
        \subsection{4-State Mealy Machine:} This style of logic was coined in George Mealy's 1955 paper “A Method for Synthesizing Sequential Circuits.” The trademark feature is that it's outputs are determined by both the current state and the current inputs. \cite{Wikipedia:MealyMachine}
        
        \subsection{4-State Moore State Machine:} created a year after the Mealy machine the Moore Machine was described in a 1956 paper Gedanken-experiments on Sequential Machines. The difference is the Moore machine is only dependant on it's current state. \cite{Wikipedia:MooreMachine}
        
        \subsection{Safe State Machine:} This style of machine uses a specific altera directive that inserts extra logic to detect invalid states and returns the state machine to the initial state.
        
        \subsection{User-Encoded State Machine:} This can be incorporated into all of the previous types. It allows the states to be named which aids in debugging and overall code readability.
        \lstinputlisting[caption=Example of enumerated state machine]{./Codesnips/StateMachineExample.sv}

      %| Important reccomendations from altera
      \subsubsection{Important reccomendations from altera}
        Quartus will recognise when you have created a state machine during synthesis. This will allow Quartus to optimize the design based on the known behavior of state machines. The Quartus II handbook offers the following reccomendations for writing state machines that we will follow.
        \begin{enumerate}
          \item Assign default values to outputs derived from the state machine so that synthesis does not generate unwanted latches.
          \item Separate the state machine logic from all arithmetic functions and data paths, including assigning output values.
          \item If your design contains an operation that is used by more than one state, define the operation outside the state machine and cause the output logic of the state machine to use this value.
          \item Use a simple asynchronous or synchronous reset to ensure a defined power-up state. If your state machine design contains more elaborate reset logic, such as both an asynchronous reset and an asynchronous load, the Quartus II software generates regular logic rather than inferring a state machine.
        \end{enumerate}
  %| =================================================================================================
  %| Procedure
  %| =================================================================================================
  \section{ Lab Procedure}
    \subsection{Case State Warmup: The Multiplexer}

  %| =================================================================================================
  %| Lab Report Requirements
  %| =================================================================================================
  \section{ Lab Report}
    

  %| =================================================================================================
  %| Conclusions
  %| =================================================================================================
  \section{ Conclusion}
   

  %| =================================================================================================
  %| Bibliography
  %| =================================================================================================
  \bibliographystyle{IEEEtran}
  \bibliography{IEEEfull}
\end{document}